(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67720,       1990]
NotebookOptionsPosition[     65266,       1905]
NotebookOutlinePosition[     65603,       1920]
CellTagsIndexPosition[     65560,       1917]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"p", " ", "=", " ", 
    RowBox[{
     RowBox[{"10", "\[IndentingNewLine]", "q"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"3", "\[IndentingNewLine]", " ", "theta"}], " ", "=", " ", 
      "0.003"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", " ", "+", " ", "q"}], ")"}], "/", "2"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"b", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"p", " ", "q"}], " ", "]"}], " ", 
     RowBox[{"Sin", "[", "theta", "]"}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"c", " ", "=", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"a", "^", "2"}], " ", "-", " ", 
      RowBox[{"b", "^", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ecc", " ", "=", " ", 
    RowBox[{"c", " ", "/", " ", "a"}]}]}]}]], "Input",
 CellChangeTimes->{{3.87195494403224*^9, 3.871954975022043*^9}, {
   3.871955009167292*^9, 3.8719550893879843`*^9}, 3.87195599476655*^9, {
   3.8719605176016893`*^9, 3.87196051779077*^9}, 3.871961005396655*^9, {
   3.871970151042899*^9, 3.871970219218896*^9}, {3.872050021252718*^9, 
   3.87205012536738*^9}, {3.872051135871088*^9, 3.872051146430087*^9}, 
   3.8720513615248623`*^9, 3.8720520469094563`*^9, {3.8720531448620443`*^9, 
   3.872053156381513*^9}, 3.8720557982533817`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p", "+", "q"}], "2"]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.87205581619984*^9}],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"p", " ", "q"}]], " ", 
  RowBox[{"Sin", "[", "theta", "]"}]}]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.872055816204986*^9}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
   RowBox[{"p", " ", "q", " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.872055816211157*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
     RowBox[{"p", " ", "q", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}], 
  RowBox[{"p", "+", "q"}]]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.872055816217573*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"b", "^", "2"}]}], ",", "0", " ", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"1", "/", 
       RowBox[{"a", "^", "2"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", 
      RowBox[{"1", "/", 
       RowBox[{"b", "^", "2"}]}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.87195494403224*^9, 3.871954975022043*^9}, {
   3.871955009167292*^9, 3.8719550893879843`*^9}, 3.87195599476655*^9, {
   3.8719605176016893`*^9, 3.87196051779077*^9}, 3.871961005396655*^9, {
   3.871970151042899*^9, 3.871970219218896*^9}, {3.872050021252718*^9, 
   3.872050075910993*^9}, {3.872051255161721*^9, 3.872051255769215*^9}, {
   3.872051321931262*^9, 3.8720513282432547`*^9}, 3.872051370685781*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"], 
      RowBox[{"p", " ", "q"}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["4", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], "2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"], 
      RowBox[{"p", " ", "q"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.871954948734323*^9, 3.871954976022172*^9}, {
   3.8719550161920977`*^9, 3.871955090576234*^9}, 3.8719559953605213`*^9, 
   3.871960518565609*^9, 3.8719605498757544`*^9, 3.871961015696855*^9, 
   3.871961542232086*^9, 3.8719698409606447`*^9, 3.8719699400401363`*^9, 
   3.871970037078628*^9, 3.871970219864835*^9, 3.872050069055523*^9, 
   3.8720501455250883`*^9, 3.872051153494001*^9, 3.872051256684572*^9, 
   3.872051329030463*^9, 3.872051366039261*^9, 3.872051607459339*^9, 
   3.872052057266656*^9, 3.8720531604046803`*^9, 3.872055776788368*^9, 
   3.872055816689139*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ycen", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", " ", "-", " ", "q"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"2", " ", "ecc"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"zcen", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", "b"}], " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ycen", "/", "a"}], ")"}], "^", "2"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.871955070352474*^9, 3.871955070353078*^9}, {
   3.871955128819785*^9, 3.8719551852032537`*^9}, {3.8719614718226357`*^9, 
   3.871961475654317*^9}, {3.871970241421218*^9, 3.871970257271886*^9}, {
   3.8720501876007233`*^9, 3.872050258652472*^9}, 3.872051408669549*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "-", "q"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"p", "+", "q"}], ")"}]}], 
  RowBox[{"4", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
     RowBox[{"p", " ", "q", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}]]], "Output",
 CellChangeTimes->{3.872050261306349*^9, 3.8720513824038553`*^9, 
  3.8720514229018784`*^9, 3.8720520573966846`*^9, 3.8720531604148808`*^9, 
  3.872055776924271*^9, 3.872055816818776*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SqrtBox[
    RowBox[{"p", " ", "q"}]]}], " ", 
  RowBox[{"Sin", "[", "theta", "]"}], " ", 
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "-", "q"}], ")"}], "2"], 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
        RowBox[{"p", " ", "q", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], 
       ")"}]}]]}]]}]], "Output",
 CellChangeTimes->{3.872050261306349*^9, 3.8720513824038553`*^9, 
  3.8720514229018784`*^9, 3.8720520573966846`*^9, 3.8720531604148808`*^9, 
  3.872055776924271*^9, 3.8720558168246*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"nny", " ", "=", 
  RowBox[{
   RowBox[{"-", " ", "2"}], " ", 
   RowBox[{"ycen", "/", 
    RowBox[{"a", "^", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"nnz", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", " ", "2"}], " ", 
   RowBox[{"zcen", "/", 
    RowBox[{"b", "^", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ny", " ", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"nny", " ", "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"nny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nnz", "^", "2"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nz", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"nnz", " ", "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"nny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nnz", "^", "2"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.871955070352474*^9, 3.871955070353078*^9}, {
  3.871955128819785*^9, 3.8719551852032537`*^9}, {3.8719614718226357`*^9, 
  3.871961475654317*^9}, {3.871970241421218*^9, 3.871970257271886*^9}, {
  3.8720501876007233`*^9, 3.872050332020615*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "q"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "+", "q"}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
      RowBox[{"p", " ", "q", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}]]}]], "Output",
 CellChangeTimes->{3.872050297086872*^9, 3.872050334149034*^9, 
  3.8720503934510107`*^9, 3.872051442172534*^9, 3.8720520575056868`*^9, 
  3.87205316051728*^9, 3.872055777054536*^9, 3.8720558169394417`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{"p", " ", "q"}]], " ", 
   RowBox[{"Csc", "[", "theta", "]"}], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
         RowBox[{"p", " ", "q", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}]]}], 
  RowBox[{"p", " ", "q"}]]], "Output",
 CellChangeTimes->{3.872050297086872*^9, 3.872050334149034*^9, 
  3.8720503934510107`*^9, 3.872051442172534*^9, 3.8720520575056868`*^9, 
  3.87205316051728*^9, 3.872055777054536*^9, 3.872055816943886*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "p"}], "+", "q"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "+", "q"}], ")"}], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["p", "2"], "+", 
     SuperscriptBox["q", "2"], "+", 
     RowBox[{"2", " ", "p", " ", "q", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
   SqrtBox[
    FractionBox[
     SuperscriptBox[
      RowBox[{"Csc", "[", "theta", "]"}], "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]], "Output",
 CellChangeTimes->{3.872050297086872*^9, 3.872050334149034*^9, 
  3.8720503934510107`*^9, 3.872051442172534*^9, 3.8720520575056868`*^9, 
  3.87205316051728*^9, 3.872055777054536*^9, 3.872055817420011*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{"p", " ", "q", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
     RowBox[{
      SuperscriptBox["p", "2"], "+", 
      SuperscriptBox["q", "2"], "+", 
      RowBox[{"2", " ", "p", " ", "q", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
   RowBox[{"Csc", "[", "theta", "]"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"p", " ", "q"}]], " ", 
   SqrtBox[
    FractionBox[
     SuperscriptBox[
      RowBox[{"Csc", "[", "theta", "]"}], "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]], "Output",
 CellChangeTimes->{3.872050297086872*^9, 3.872050334149034*^9, 
  3.8720503934510107`*^9, 3.872051442172534*^9, 3.8720520575056868`*^9, 
  3.87205316051728*^9, 3.872055777054536*^9, 3.872055817989143*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"thetaeuler", " ", "=", 
  RowBox[{"ArcSin", "[", "ny", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rot", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Cos", "[", "thetaeuler", "]"}], ",", " ", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "thetaeuler", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Sin", "[", "thetaeuler", "]"}], ",", " ", 
      RowBox[{"Cos", "[", "thetaeuler", "]"}]}], "}"}]}], "}"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.871955070352474*^9, 3.871955070353078*^9}, {
  3.871955128819785*^9, 3.8719551852032537`*^9}, {3.8719614718226357`*^9, 
  3.871961475654317*^9}, {3.871970241421218*^9, 3.871970257271886*^9}, {
  3.8720501876007233`*^9, 3.872050294403409*^9}, {3.872050449603758*^9, 
  3.872050453775372*^9}, {3.872051516136685*^9, 3.872051531136348*^9}}],

Cell[BoxData[
 RowBox[{"ArcSin", "[", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p"}], "+", "q"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "+", "q"}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["p", "2"], "+", 
      SuperscriptBox["q", "2"], "+", 
      RowBox[{"2", " ", "p", " ", "q", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
    SqrtBox[
     FractionBox[
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]], "]"}]], "Output",
 CellChangeTimes->{3.871960556228944*^9, 3.8719610287355223`*^9, 
  3.871961479000008*^9, 3.871961547702608*^9, 3.871969844408609*^9, 
  3.871969942849144*^9, 3.871970042609335*^9, 3.87197025791817*^9, 
  3.872050253117285*^9, 3.872050288173171*^9, 3.87205040678433*^9, 
  3.872050541993043*^9, 3.872051457461732*^9, 3.872051534737062*^9, 
  3.872052058586376*^9, 3.87205316066463*^9, 3.872055777314816*^9, 
  3.8720558184195232`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "p"}], "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p"}], "+", "q"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p"}], "+", "q"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]], ",", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "p"}], "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.871960556228944*^9, 3.8719610287355223`*^9, 
  3.871961479000008*^9, 3.871961547702608*^9, 3.871969844408609*^9, 
  3.871969942849144*^9, 3.871970042609335*^9, 3.87197025791817*^9, 
  3.872050253117285*^9, 3.872050288173171*^9, 3.87205040678433*^9, 
  3.872050541993043*^9, 3.872051457461732*^9, 3.872051534737062*^9, 
  3.872052058586376*^9, 3.87205316066463*^9, 3.872055777314816*^9, 
  3.872055818427301*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.8719552382149477`*^9, 3.8719553325601053`*^9}, {
   3.871955382927808*^9, 3.8719554456348763`*^9}, {3.871955513914694*^9, 
   3.8719555222432127`*^9}, {3.871955603894659*^9, 3.871955625413144*^9}, {
   3.871955660087963*^9, 3.871955665477708*^9}, 3.871955696103846*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "rot", "]"}], " ", "//", "MatrixForm", 
  " "}]], "Input",
 CellChangeTimes->{{3.87195556996418*^9, 3.871955595891799*^9}, {
   3.871955632156754*^9, 3.8719556323492527`*^9}, 3.871956005126485*^9, {
   3.871956986172904*^9, 3.8719569890047398`*^9}, {3.871957313925716*^9, 
   3.871957316692428*^9}, {3.8719605761450872`*^9, 3.871960579936249*^9}, {
   3.871961298883184*^9, 3.871961303210236*^9}, 3.8719613493010197`*^9, {
   3.8719615807413*^9, 3.8719615810567427`*^9}, {3.87196996836689*^9, 
   3.8719699687166147`*^9}, 3.8720505649265537`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      SqrtBox[
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]], 
      FractionBox[
       RowBox[{"p", "-", "q"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p"}], "+", "q"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]], 
      SqrtBox[
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8719556931658792`*^9, 3.871956005931287*^9, 3.8719569904477997`*^9, 
   3.8719573171266623`*^9, 3.8719605260946827`*^9, {3.87196057193318*^9, 
   3.871960580524465*^9}, 3.871961035384675*^9, 3.871961563499754*^9, 
   3.871961724827343*^9, 3.871969849730095*^9, {3.871969948499279*^9, 
   3.871969969229631*^9}, 3.871970048226815*^9, 3.871970263135054*^9, 
   3.872050567135459*^9, 3.872051552531618*^9, 3.872052058928996*^9, 
   3.872053160825467*^9, 3.872055778031905*^9, 3.8720558188976307`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rar", " ", "=", 
   RowBox[{"FullSimplify", "[", " ", 
    RowBox[{"rot", " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{"cmat", " ", ".", " ", 
       RowBox[{"Transpose", "[", "rot", "]"}]}], ")"}]}], " ", "]"}]}], " ", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.871955706846756*^9, 3.87195572858391*^9}, {
   3.8719560096543016`*^9, 3.8719560126461487`*^9}, 3.871969955699811*^9, 
   3.872050588565818*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"], 
      RowBox[{"p", " ", "q"}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      RowBox[{"p", " ", "q"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
      RowBox[{"p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
      RowBox[{"p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
      RowBox[{"p", " ", "q", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.871955729375677*^9, 3.871956013044174*^9, 
  3.8719619278845463`*^9, 3.871969852605996*^9, 3.871969956960218*^9, 
  3.871970056139244*^9, 3.871970286195902*^9, 3.872050591470173*^9, 
  3.872051560598302*^9, 3.872051621195261*^9, 3.872052059957274*^9, 
  3.872053160940016*^9, 3.872055778387273*^9, 3.872055820075802*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rar", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.871956057775755*^9, 3.871956073255414*^9}, {
  3.871956136961657*^9, 3.8719561398887167`*^9}, {3.871970386472742*^9, 
  3.871970394687213*^9}, {3.87205061593316*^9, 3.8720506282567863`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       RowBox[{"p", " ", "q"}]], "0", "0"},
     {"0", 
      FractionBox["1", 
       RowBox[{"p", " ", "q"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
       RowBox[{"p", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
       RowBox[{"p", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
       RowBox[{"p", " ", "q", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.872050630337021*^9, 3.87205156608984*^9, 
  3.872051627233548*^9, 3.8720517741584*^9, 3.872052060062269*^9, 
  3.872053161092401*^9, 3.872055779141067*^9, 3.8720558203962727`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cvec", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"c0", " ", "=", " ", 
  RowBox[{"-", "1"}]}]}], "Input",
 CellChangeTimes->{{3.871956057775755*^9, 3.871956073255414*^9}, {
  3.871956136961657*^9, 3.8719561398887167`*^9}, {3.871970386472742*^9, 
  3.871970394687213*^9}, {3.87205061593316*^9, 3.8720506282567863`*^9}, {
  3.872050662120566*^9, 3.872050669502664*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.871970387161214*^9, 3.8719703951402683`*^9}, 
   3.872050670070136*^9, 3.8720516436960382`*^9, 3.8720520601467323`*^9, 
   3.872053161102992*^9, 3.872055779544623*^9, 3.872055820512349*^9}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.871970387161214*^9, 3.8719703951402683`*^9}, 
   3.872050670070136*^9, 3.8720516436960382`*^9, 3.8720520601467323`*^9, 
   3.872053161102992*^9, 3.872055779544623*^9, 3.8720558205187693`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"center", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "ycen", ",", "zcen"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.871970295141213*^9, 3.87197031070999*^9}, {
  3.872050679413041*^9, 3.872050692387804*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "q"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p", "+", "q"}], ")"}]}], 
    RowBox[{"4", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
       RowBox[{"p", " ", "q", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"p", " ", "q"}]]}], " ", 
    RowBox[{"Sin", "[", "theta", "]"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
          RowBox[{"p", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.871970311252408*^9, 3.872050693044695*^9, 
  3.872051649477992*^9, 3.872052060230006*^9, 3.872053161229253*^9, 
  3.872055780364147*^9, 3.8720558206270933`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", " ", 
    RowBox[{"rot", " ", ".", " ", "center"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.871956079430187*^9, 3.871956096951529*^9}, {
  3.871970342935034*^9, 3.871970350029743*^9}, {3.8720507041962*^9, 
  3.872050730448256*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "-", "q"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"p", "+", "q"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "3"]}], "-", 
        RowBox[{"4", " ", 
         SqrtBox[
          RowBox[{"p", " ", "q"}]], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{"p", " ", "q", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
         SqrtBox[
          FractionBox[
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "3"]}], 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p", "2"], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "-", "q"}], ")"}], "2"], "+", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", " ", "q"}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "theta", "]"}], "2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]]], " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}], 
      SqrtBox[
       FractionBox[
        RowBox[{"p", " ", "q", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]]]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"2", " ", "p", " ", "q", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
     SqrtBox[
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8719619651546097`*^9, 3.871969860370893*^9, 3.87197007374214*^9, 
   3.8719703503804502`*^9, 3.8719703994614153`*^9, {3.8720507059068203`*^9, 
   3.8720507348914137`*^9}, 3.872051654274811*^9, 3.8720520661078863`*^9, 
   3.8720531613869257`*^9, 3.87205578052719*^9, 3.87205582634296*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.871956125192705*^9, 3.871956150672089*^9}, {
   3.871956308860757*^9, 3.8719563098354816`*^9}, 3.8719619763379717`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rot", " ", ".", " ", "cvec"}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"rar", " ", ".", " ", "t"}]}]}], "]"}], " ", "//", "MatrixForm",
    " "}]}]], "Input",
 CellChangeTimes->{{3.8719563128463984`*^9, 3.871956461256502*^9}, {
  3.8719628158540573`*^9, 3.871962819309844*^9}, {3.87196294903153*^9, 
  3.87196294955331*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SqrtBox[
              RowBox[{"p", " ", "q"}]]}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{"p", " ", "q", " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "p", " ", "q", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
            RowBox[{"Csc", "[", "theta", "]"}]}], "+", 
           RowBox[{"p", " ", "q", " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "p", " ", "q", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
            SqrtBox[
             FractionBox[
              SuperscriptBox[
               RowBox[{"Csc", "[", "theta", "]"}], "2"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]}], ")"}]}], 
        RowBox[{"p", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
         SqrtBox[
          FractionBox[
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SqrtBox[
           FractionBox[
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"]]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["p", "2"], "-", 
                SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cot", "[", "theta", "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["p", "2"], "+", 
                  RowBox[{"6", " ", "p", " ", "q"}], "+", 
                  SuperscriptBox["q", "2"]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "theta"}], "]"}]}], "+", 
               FractionBox[
                RowBox[{"8", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", " ", "q"}], ")"}], 
                  RowBox[{"3", "/", "2"}]], " ", 
                 RowBox[{"Cos", "[", "theta", "]"}], " ", 
                 SqrtBox[
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
                   RowBox[{
                    SuperscriptBox["p", "2"], "+", 
                    SuperscriptBox["q", "2"], "+", 
                    RowBox[{"2", " ", "p", " ", "q", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
                 RowBox[{"Cot", "[", "theta", "]"}]}], 
                RowBox[{
                 SqrtBox[
                  FractionBox[
                   RowBox[{"p", " ", "q", " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
                   RowBox[{
                    SuperscriptBox["p", "2"], "+", 
                    SuperscriptBox["q", "2"], "+", 
                    RowBox[{"2", " ", "p", " ", "q", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
                 SqrtBox[
                  FractionBox[
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]}], ")"}]}]}], 
           ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.871961983105983*^9, 3.871962819806587*^9, 
  3.8719629516586103`*^9, 3.871969805617833*^9, 3.87197007951898*^9, 
  3.871970357129796*^9, 3.871970403470895*^9, 3.872050766568801*^9, 
  3.872051685783784*^9, 3.872052125915866*^9, 3.872053161549988*^9, 
  3.872055780999729*^9, 3.8720558883931723`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"c0", " ", "+", "  ", 
   RowBox[{"t", " ", ".", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rar", " ", ".", " ", "t"}], " ", "-", " ", 
      RowBox[{"rot", " ", ".", " ", "cvec"}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.871956571715913*^9, 3.871956679445367*^9}, {
  3.8719704439137983`*^9, 3.8719704731122417`*^9}, {3.872050791374851*^9, 
  3.8720507963342047`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.871956578330715*^9, 3.8719566799915867`*^9}, 
   3.871962984366995*^9, 3.871970088643298*^9, {3.871970446794465*^9, 
   3.871970473804875*^9}, 3.872050799059103*^9, 3.8720517006433563`*^9, 
   3.8720521505498257`*^9, 3.8720531616713533`*^9, 3.872055781081345*^9, 
   3.872055911774721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cpmat", " ", "=", " ", "rar"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpvec", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rot", " ", ".", " ", "cvec"}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"rar", " ", ".", " ", "t"}]}]}], " ", "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"cp0", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"c0", " ", "+", " ", 
    RowBox[{"t", " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rar", " ", ".", " ", "t"}], " ", "-", " ", 
       RowBox[{"rot", " ", ".", " ", "cvec"}]}], ")"}]}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.872050875481427*^9, 3.872050876472073*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"], 
      RowBox[{"p", " ", "q"}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      RowBox[{"p", " ", "q"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
      RowBox[{"p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
      RowBox[{"p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
      RowBox[{"p", " ", "q", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.872050824189149*^9, 3.872050877077427*^9, 
  3.8720517090764637`*^9, 3.8720517864238167`*^9, 3.872052150660898*^9, 
  3.872053161684299*^9, 3.872055781305004*^9, 3.872055911946745*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "q"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"p", " ", "q"}]]}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{"p", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
        RowBox[{"Csc", "[", "theta", "]"}]}], "+", 
       RowBox[{"p", " ", "q", " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]}], ")"}]}], 
    RowBox[{"p", " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{"p", "+", "q"}], ")"}], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"2", " ", "p", " ", "q", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
     SqrtBox[
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]], ",", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]], 
     RowBox[{
      SqrtBox[
       FractionBox[
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"]]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "-", 
            SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cot", "[", "theta", "]"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              RowBox[{"6", " ", "p", " ", "q"}], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{"8", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", " ", "q"}], ")"}], 
              RowBox[{"3", "/", "2"}]], " ", 
             RowBox[{"Cos", "[", "theta", "]"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
             RowBox[{"Cot", "[", "theta", "]"}]}], 
            RowBox[{
             SqrtBox[
              FractionBox[
               RowBox[{"p", " ", "q", " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
             SqrtBox[
              FractionBox[
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]}], ")"}]}]}], 
       ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872050824189149*^9, 3.872050877077427*^9, 
  3.8720517090764637`*^9, 3.8720517864238167`*^9, 3.872052150660898*^9, 
  3.872053161684299*^9, 3.872055781305004*^9, 3.872055914681806*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.872050824189149*^9, 3.872050877077427*^9, 
  3.8720517090764637`*^9, 3.8720517864238167`*^9, 3.872052150660898*^9, 
  3.872053161684299*^9, 3.872055781305004*^9, 3.8720559257681923`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", "cp0"}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.87205188924839*^9, 3.872051895751671*^9}, {
   3.872056394049391*^9, 3.8720563976676188`*^9}, 3.872056630780637*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"Csc", "[", "theta", "]"}], "2"], 
    RowBox[{"p", " ", "q"}]], ",", 
   FractionBox["1", 
    RowBox[{"p", " ", "q"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
    RowBox[{"p", " ", "q", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "+", "q"}], ")"}], "2"]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "q"}], ")"}], " ", 
     SqrtBox[
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
       RowBox[{
        SuperscriptBox["p", "2"], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"2", " ", "p", " ", "q", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
     SqrtBox[
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]]]}], 
    RowBox[{"p", " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{"p", "+", "q"}], ")"}]}]], ",", "0", ",", "0", ",", 
   FractionBox[
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "q"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"p", " ", "q"}]]}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{"p", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
        RowBox[{"Csc", "[", "theta", "]"}]}], "+", 
       RowBox[{"p", " ", "q", " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
        SqrtBox[
         FractionBox[
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]}], ")"}]}], 
    RowBox[{"p", " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{"p", "+", "q"}], ")"}], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"2", " ", "p", " ", "q", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
     SqrtBox[
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]], ",", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]], 
     RowBox[{
      SqrtBox[
       FractionBox[
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"]]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "-", 
            SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cot", "[", "theta", "]"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              RowBox[{"6", " ", "p", " ", "q"}], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{"8", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", " ", "q"}], ")"}], 
              RowBox[{"3", "/", "2"}]], " ", 
             RowBox[{"Cos", "[", "theta", "]"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
             RowBox[{"Cot", "[", "theta", "]"}]}], 
            RowBox[{
             SqrtBox[
              FractionBox[
               RowBox[{"p", " ", "q", " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "theta", "]"}], "2"]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
             SqrtBox[
              FractionBox[
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "+", "q"}], ")"}], "2"]]]}]]}], ")"}]}]}], 
       ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.872050847365402*^9, 3.8720508808498573`*^9, 
  3.872051716029755*^9, 3.872051790887109*^9, 3.87205189760719*^9, 
  3.872052160902172*^9, 3.8720531618205957`*^9, 3.87205578140949*^9, 
  3.872055926215605*^9, 3.872056399016748*^9, 3.872056631213182*^9}]
}, Open  ]]
},
WindowSize->{1386, 842},
WindowMargins->{{Automatic, 330}, {Automatic, 99}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1455, 33, 209, "Input"],
Cell[2038, 57, 305, 6, 53, "Output"],
Cell[2346, 65, 355, 8, 38, "Output"],
Cell[2704, 75, 520, 14, 75, "Output"],
Cell[3227, 91, 606, 17, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3870, 113, 898, 21, 32, "Input"],
Cell[4771, 136, 1203, 29, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6011, 170, 743, 18, 55, "Input"],
Cell[6757, 190, 657, 20, 87, "Output"],
Cell[7417, 212, 829, 26, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8283, 243, 1136, 29, 121, "Input"],
Cell[9422, 274, 710, 21, 87, "Output"],
Cell[10135, 297, 894, 26, 103, "Output"],
Cell[11032, 325, 774, 23, 86, "Output"],
Cell[11809, 350, 901, 27, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12747, 382, 984, 22, 55, "Input"],
Cell[13734, 406, 1056, 28, 86, "Output"],
Cell[14793, 436, 3013, 89, 207, "Output"]
}, Open  ]],
Cell[17821, 528, 337, 4, 55, "Input"],
Cell[CellGroupData[{
Cell[18183, 536, 601, 10, 32, "Input"],
Cell[18787, 548, 3323, 93, 196, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22147, 646, 463, 11, 55, "Input"],
Cell[22613, 659, 3557, 106, 183, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26207, 770, 284, 4, 32, "Input"],
Cell[26494, 776, 3863, 113, 197, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30394, 894, 452, 9, 55, "Input"],
Cell[30849, 905, 295, 5, 32, "Output"],
Cell[31147, 912, 259, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31443, 921, 241, 5, 32, "Input"],
Cell[31687, 928, 1394, 45, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33118, 978, 326, 7, 32, "Input"],
Cell[33447, 987, 4302, 125, 287, "Output"]
}, Open  ]],
Cell[37764, 1115, 168, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[37957, 1121, 438, 11, 32, "Input"],
Cell[38398, 1134, 6916, 179, 256, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45351, 1318, 446, 10, 32, "Input"],
Cell[45800, 1330, 340, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46177, 1340, 728, 19, 77, "Input"],
Cell[46908, 1361, 3421, 104, 183, "Output"],
Cell[50332, 1467, 5669, 160, 375, "Output"],
Cell[56004, 1629, 236, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56277, 1637, 1464, 44, 55, "Input"],
Cell[57744, 1683, 7506, 219, 504, "Output"]
}, Open  ]]
}
]
*)

