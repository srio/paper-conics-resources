(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    125735,       3437]
NotebookOptionsPosition[    123130,       3348]
NotebookOutlinePosition[    123464,       3363]
CellTagsIndexPosition[    123421,       3360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"p", " ", "=", " ", 
    RowBox[{
     RowBox[{"10", "\[IndentingNewLine]", "q"}], " ", "=", 
     RowBox[{
      RowBox[{"3", "\[IndentingNewLine]", "theta"}], " ", "=", " ", 
      "0.003"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", " ", "-", " ", "q"}], ")"}], "/", "2"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"b", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"p", " ", "q"}], " ", "]"}], " ", 
     RowBox[{"Sin", "[", "theta", "]"}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"c", " ", "=", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"a", "^", "2"}], " ", "-", " ", 
      RowBox[{"b", "^", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ecc", " ", "=", " ", 
    RowBox[{"c", " ", "/", " ", "a"}]}]}]}]], "Input",
 CellChangeTimes->{{3.87195494403224*^9, 3.871954975022043*^9}, {
   3.871955009167292*^9, 3.8719550893879843`*^9}, 3.87195599476655*^9, {
   3.8719605176016893`*^9, 3.87196051779077*^9}, 3.871961005396655*^9, {
   3.871970151042899*^9, 3.871970219218896*^9}, {3.872050021252718*^9, 
   3.87205012536738*^9}, {3.872051135871088*^9, 3.872051146430087*^9}, 
   3.8720513615248623`*^9, 3.8720520469094563`*^9, {3.8720531448620443`*^9, 
   3.872053156381513*^9}, 3.8720557982533817`*^9, {3.8722405127601852`*^9, 
   3.872240542599174*^9}, 3.87224079692906*^9, {3.872241338309629*^9, 
   3.8722413657138777`*^9}, {3.872241639338854*^9, 3.87224163999794*^9}, {
   3.8722417298954782`*^9, 3.8722417862008867`*^9}, {3.872241878899446*^9, 
   3.872241881306704*^9}, {3.872242221321691*^9, 3.872242244254915*^9}, 
   3.872242378468484*^9, {3.872242456860614*^9, 3.872242458769999*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p", "-", "q"}], "2"]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.87205581619984*^9, 
   3.872240729016168*^9, 3.8722407752864733`*^9, 3.8722408490529013`*^9, 
   3.87224102487779*^9, 3.872241120461791*^9, 3.872241268068221*^9, {
   3.872241346914628*^9, 3.8722413700359707`*^9}, {3.872241767144774*^9, 
   3.872241788713018*^9}, 3.8722418333787823`*^9, 3.872241884277618*^9, 
   3.872242086231402*^9, 3.872242286389144*^9, 3.872242316714566*^9, {
   3.872242382334989*^9, 3.8722423950161963`*^9}, 3.872242465626267*^9}],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"p", " ", "q"}]], " ", 
  RowBox[{"Sin", "[", "theta", "]"}]}]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.87205581619984*^9, 
   3.872240729016168*^9, 3.8722407752864733`*^9, 3.8722408490529013`*^9, 
   3.87224102487779*^9, 3.872241120461791*^9, 3.872241268068221*^9, {
   3.872241346914628*^9, 3.8722413700359707`*^9}, {3.872241767144774*^9, 
   3.872241788713018*^9}, 3.8722418333787823`*^9, 3.872241884277618*^9, 
   3.872242086231402*^9, 3.872242286389144*^9, 3.872242316714566*^9, {
   3.872242382334989*^9, 3.8722423950161963`*^9}, 3.872242465630838*^9}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
   RowBox[{"p", " ", "q", " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.87205581619984*^9, 
   3.872240729016168*^9, 3.8722407752864733`*^9, 3.8722408490529013`*^9, 
   3.87224102487779*^9, 3.872241120461791*^9, 3.872241268068221*^9, {
   3.872241346914628*^9, 3.8722413700359707`*^9}, {3.872241767144774*^9, 
   3.872241788713018*^9}, 3.8722418333787823`*^9, 3.872241884277618*^9, 
   3.872242086231402*^9, 3.872242286389144*^9, 3.872242316714566*^9, {
   3.872242382334989*^9, 3.8722423950161963`*^9}, 3.872242465632843*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
     RowBox[{"p", " ", "q", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}], 
  RowBox[{"p", "-", "q"}]]], "Output",
 CellChangeTimes->{
  3.872050078043886*^9, {3.872050114788422*^9, 3.872050125965987*^9}, 
   3.8720511482869043`*^9, 3.8720513624059677`*^9, 3.872052056948658*^9, 
   3.872053160104031*^9, 3.872055776204625*^9, 3.87205581619984*^9, 
   3.872240729016168*^9, 3.8722407752864733`*^9, 3.8722408490529013`*^9, 
   3.87224102487779*^9, 3.872241120461791*^9, 3.872241268068221*^9, {
   3.872241346914628*^9, 3.8722413700359707`*^9}, {3.872241767144774*^9, 
   3.872241788713018*^9}, 3.8722418333787823`*^9, 3.872241884277618*^9, 
   3.872242086231402*^9, 3.872242286389144*^9, 3.872242316714566*^9, {
   3.872242382334989*^9, 3.8722423950161963`*^9}, 3.872242465634768*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"b", "^", "2"}]}], ",", "0", " ", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"1", "/", 
       RowBox[{"a", "^", "2"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"b", "^", "2"}]}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.87195494403224*^9, 3.871954975022043*^9}, {
   3.871955009167292*^9, 3.8719550893879843`*^9}, 3.87195599476655*^9, {
   3.8719605176016893`*^9, 3.87196051779077*^9}, 3.871961005396655*^9, {
   3.871970151042899*^9, 3.871970219218896*^9}, {3.872050021252718*^9, 
   3.872050075910993*^9}, {3.872051255161721*^9, 3.872051255769215*^9}, {
   3.872051321931262*^9, 3.8720513282432547`*^9}, 3.872051370685781*^9, {
   3.872240600070616*^9, 3.872240605814292*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       RowBox[{"p", " ", "q"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["4", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       RowBox[{"p", " ", "q"}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.871954948734323*^9, 3.871954976022172*^9}, {
   3.8719550161920977`*^9, 3.871955090576234*^9}, 3.8719559953605213`*^9, 
   3.871960518565609*^9, 3.8719605498757544`*^9, 3.871961015696855*^9, 
   3.871961542232086*^9, 3.8719698409606447`*^9, 3.8719699400401363`*^9, 
   3.871970037078628*^9, 3.871970219864835*^9, 3.872050069055523*^9, 
   3.8720501455250883`*^9, 3.872051153494001*^9, 3.872051256684572*^9, 
   3.872051329030463*^9, 3.872051366039261*^9, 3.872051607459339*^9, 
   3.872052057266656*^9, 3.8720531604046803`*^9, 3.872055776788368*^9, 
   3.872055816689139*^9, 3.872240729193059*^9, 3.8722407755505466`*^9, 
   3.872240849355191*^9, 3.8722410252094183`*^9, 3.872241120709301*^9, 
   3.872241268375648*^9, {3.872241347210648*^9, 3.8722413703902617`*^9}, 
   3.8722418336392508`*^9, 3.8722418845276203`*^9, 3.872242086489605*^9, 
   3.872242286651696*^9, 3.872242316963008*^9, {3.872242382586914*^9, 
   3.872242395192165*^9}, 3.87224246589342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ycen", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"p", "^", "2"}], " ", "-", " ", 
     RowBox[{"q", "^", "2"}]}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "c"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"zcen", " ", "=", " ", 
  RowBox[{"b", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ycen", "/", "a"}], ")"}], "^", "2"}], " ", "-", " ", "1"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.871955070352474*^9, 3.871955070353078*^9}, {
   3.871955128819785*^9, 3.8719551852032537`*^9}, {3.8719614718226357`*^9, 
   3.871961475654317*^9}, {3.871970241421218*^9, 3.871970257271886*^9}, {
   3.8720501876007233`*^9, 3.872050258652472*^9}, 3.872051408669549*^9, {
   3.8722406534471827`*^9, 3.8722406843743677`*^9}, {3.872240823913093*^9, 
   3.87224084201243*^9}, 3.872241109926353*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["p", "2"], "-", 
   SuperscriptBox["q", "2"]}], 
  RowBox[{"4", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
     RowBox[{"p", " ", "q", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}]]], "Output",
 CellChangeTimes->{{3.872240845026895*^9, 3.872240849431368*^9}, 
   3.8722410252835712`*^9, 3.872241120777979*^9, 3.872241268459468*^9, {
   3.872241347277598*^9, 3.872241370462994*^9}, 3.872241833717229*^9, 
   3.872241884599588*^9, 3.872242086565901*^9, 3.8722422867287073`*^9, 
   3.872242317037071*^9, {3.872242382659748*^9, 3.872242395268832*^9}, 
   3.872242465963582*^9}],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"p", " ", "q"}]], " ", 
  RowBox[{"Sin", "[", "theta", "]"}], " ", 
  SqrtBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        SuperscriptBox["q", "2"]}], ")"}], "2"], 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
        RowBox[{"p", " ", "q", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], 
       ")"}]}]]}]]}]], "Output",
 CellChangeTimes->{{3.872240845026895*^9, 3.872240849431368*^9}, 
   3.8722410252835712`*^9, 3.872241120777979*^9, 3.872241268459468*^9, {
   3.872241347277598*^9, 3.872241370462994*^9}, 3.872241833717229*^9, 
   3.872241884599588*^9, 3.872242086565901*^9, 3.8722422867287073`*^9, 
   3.872242317037071*^9, {3.872242382659748*^9, 3.872242395268832*^9}, 
   3.872242465966097*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"nny", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", " ", "2"}], " ", 
   RowBox[{"ycen", "/", 
    RowBox[{"a", "^", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"nnz", " ", "=", " ", 
  RowBox[{"2", " ", 
   RowBox[{"zcen", "/", 
    RowBox[{"b", "^", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ny", " ", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"nny", " ", "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"nny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nnz", "^", "2"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nz", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"nnz", " ", "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"nny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nnz", "^", "2"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.871955070352474*^9, 3.871955070353078*^9}, {
  3.871955128819785*^9, 3.8719551852032537`*^9}, {3.8719614718226357`*^9, 
  3.871961475654317*^9}, {3.871970241421218*^9, 3.871970257271886*^9}, {
  3.8720501876007233`*^9, 3.872050332020615*^9}, {3.872240701111771*^9, 
  3.87224070133489*^9}, {3.872241803434619*^9, 3.8722418273999653`*^9}, {
  3.872242258226039*^9, 3.872242280382946*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["p", "2"], "-", 
      SuperscriptBox["q", "2"]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
      RowBox[{"p", " ", "q", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}]]}]], "Output",
 CellChangeTimes->{
  3.872050297086872*^9, 3.872050334149034*^9, 3.8720503934510107`*^9, 
   3.872051442172534*^9, 3.8720520575056868`*^9, 3.87205316051728*^9, 
   3.872055777054536*^9, 3.8720558169394417`*^9, 3.872240729483303*^9, 
   3.872240775890634*^9, 3.8722408494561443`*^9, 3.872241025359317*^9, 
   3.8722411208517017`*^9, {3.8722412571818647`*^9, 3.872241268539756*^9}, {
   3.872241347351255*^9, 3.872241370535804*^9}, 3.872241833792281*^9, 
   3.87224188467423*^9, 3.8722420866459713`*^9, 3.872242286801536*^9, 
   3.8722423171171303`*^9, {3.872242382734991*^9, 3.872242395347062*^9}, 
   3.87224246603901*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{"p", " ", "q"}]], " ", 
   RowBox[{"Csc", "[", "theta", "]"}], " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "-", 
         SuperscriptBox["q", "2"]}], ")"}], "2"], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
         RowBox[{"p", " ", "q", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}]]}], 
  RowBox[{"p", " ", "q"}]]], "Output",
 CellChangeTimes->{
  3.872050297086872*^9, 3.872050334149034*^9, 3.8720503934510107`*^9, 
   3.872051442172534*^9, 3.8720520575056868`*^9, 3.87205316051728*^9, 
   3.872055777054536*^9, 3.8720558169394417`*^9, 3.872240729483303*^9, 
   3.872240775890634*^9, 3.8722408494561443`*^9, 3.872241025359317*^9, 
   3.8722411208517017`*^9, {3.8722412571818647`*^9, 3.872241268539756*^9}, {
   3.872241347351255*^9, 3.872241370535804*^9}, 3.872241833792281*^9, 
   3.87224188467423*^9, 3.8722420866459713`*^9, 3.872242286801536*^9, 
   3.8722423171171303`*^9, {3.872242382734991*^9, 3.872242395347062*^9}, 
   3.872242466040461*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "p"}], "-", "q"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "-", "q"}], ")"}], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["p", "2"], "-", 
     RowBox[{"4", " ", "p", " ", "q"}], "+", 
     SuperscriptBox["q", "2"], "+", 
     RowBox[{"2", " ", "p", " ", "q", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        RowBox[{"4", " ", "p", " ", "q"}], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]], "Output",
 CellChangeTimes->{
  3.872050297086872*^9, 3.872050334149034*^9, 3.8720503934510107`*^9, 
   3.872051442172534*^9, 3.8720520575056868`*^9, 3.87205316051728*^9, 
   3.872055777054536*^9, 3.8720558169394417`*^9, 3.872240729483303*^9, 
   3.872240775890634*^9, 3.8722408494561443`*^9, 3.872241025359317*^9, 
   3.8722411208517017`*^9, {3.8722412571818647`*^9, 3.872241268539756*^9}, {
   3.872241347351255*^9, 3.872241370535804*^9}, 3.872241833792281*^9, 
   3.87224188467423*^9, 3.8722420866459713`*^9, 3.872242286801536*^9, 
   3.8722423171171303`*^9, {3.872242382734991*^9, 3.872242395347062*^9}, 
   3.872242468173852*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Csc", "[", "theta", "]"}], " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"p", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "theta", "]"}], "2"]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["p", "2"], "-", 
      RowBox[{"4", " ", "p", " ", "q"}], "+", 
      SuperscriptBox["q", "2"], "+", 
      RowBox[{"2", " ", "p", " ", "q", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "theta"}], "]"}]}]}]]]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"p", " ", "q"}]], " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        RowBox[{"4", " ", "p", " ", "q"}], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]], "Output",
 CellChangeTimes->{
  3.872050297086872*^9, 3.872050334149034*^9, 3.8720503934510107`*^9, 
   3.872051442172534*^9, 3.8720520575056868`*^9, 3.87205316051728*^9, 
   3.872055777054536*^9, 3.8720558169394417`*^9, 3.872240729483303*^9, 
   3.872240775890634*^9, 3.8722408494561443`*^9, 3.872241025359317*^9, 
   3.8722411208517017`*^9, {3.8722412571818647`*^9, 3.872241268539756*^9}, {
   3.872241347351255*^9, 3.872241370535804*^9}, 3.872241833792281*^9, 
   3.87224188467423*^9, 3.8722420866459713`*^9, 3.872242286801536*^9, 
   3.8722423171171303`*^9, {3.872242382734991*^9, 3.872242395347062*^9}, 
   3.872242469466229*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"thetaeuler", " ", "=", " ", 
  RowBox[{"ArcSin", "[", "ny", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rot", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Cos", "[", "thetaeuler", "]"}], ",", " ", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "thetaeuler", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Sin", "[", "thetaeuler", "]"}], ",", " ", 
      RowBox[{"Cos", "[", "thetaeuler", "]"}]}], "}"}]}], "}"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.871955070352474*^9, 3.871955070353078*^9}, {
   3.871955128819785*^9, 3.8719551852032537`*^9}, {3.8719614718226357`*^9, 
   3.871961475654317*^9}, {3.871970241421218*^9, 3.871970257271886*^9}, {
   3.8720501876007233`*^9, 3.872050294403409*^9}, {3.872050449603758*^9, 
   3.872050453775372*^9}, {3.872051516136685*^9, 3.872051531136348*^9}, {
   3.872242077729803*^9, 3.872242079180875*^9}, 3.8722422645120792`*^9}],

Cell[BoxData[
 RowBox[{"ArcSin", "[", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p"}], "-", "q"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "-", "q"}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["p", "2"], "-", 
      RowBox[{"4", " ", "p", " ", "q"}], "+", 
      SuperscriptBox["q", "2"], "+", 
      RowBox[{"2", " ", "p", " ", "q", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "-", 
         RowBox[{"4", " ", "p", " ", "q"}], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.871960556228944*^9, 3.8719610287355223`*^9, 3.871961479000008*^9, 
   3.871961547702608*^9, 3.871969844408609*^9, 3.871969942849144*^9, 
   3.871970042609335*^9, 3.87197025791817*^9, 3.872050253117285*^9, 
   3.872050288173171*^9, 3.87205040678433*^9, 3.872050541993043*^9, 
   3.872051457461732*^9, 3.872051534737062*^9, 3.872052058586376*^9, 
   3.87205316066463*^9, 3.872055777314816*^9, 3.8720558184195232`*^9, 
   3.872240729631445*^9, 3.872240776032679*^9, 3.872240849530842*^9, 
   3.8722410254360847`*^9, 3.872241120938013*^9, 3.8722412686165953`*^9, {
   3.8722413474302197`*^9, 3.872241370613813*^9}, 3.872241833867632*^9, 
   3.872241884749408*^9, 3.872242086720006*^9, 3.872242286876585*^9, 
   3.872242317198113*^9, 3.872242382810575*^9, 3.872242431244499*^9, 
   3.872242469643568*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "-", "q"}], ")"}], "2"], 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p"}], "-", "q"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p"}], "-", "q"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p", "2"], "-", 
         RowBox[{"4", " ", "p", " ", "q"}], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "-", 
            RowBox[{"4", " ", "p", " ", "q"}], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], ",", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "-", "q"}], ")"}], "2"], 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}]]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.871960556228944*^9, 3.8719610287355223`*^9, 3.871961479000008*^9, 
   3.871961547702608*^9, 3.871969844408609*^9, 3.871969942849144*^9, 
   3.871970042609335*^9, 3.87197025791817*^9, 3.872050253117285*^9, 
   3.872050288173171*^9, 3.87205040678433*^9, 3.872050541993043*^9, 
   3.872051457461732*^9, 3.872051534737062*^9, 3.872052058586376*^9, 
   3.87205316066463*^9, 3.872055777314816*^9, 3.8720558184195232`*^9, 
   3.872240729631445*^9, 3.872240776032679*^9, 3.872240849530842*^9, 
   3.8722410254360847`*^9, 3.872241120938013*^9, 3.8722412686165953`*^9, {
   3.8722413474302197`*^9, 3.872241370613813*^9}, 3.872241833867632*^9, 
   3.872241884749408*^9, 3.872242086720006*^9, 3.872242286876585*^9, 
   3.872242317198113*^9, 3.872242382810575*^9, 3.872242431244499*^9, 
   3.872242469645925*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.8719552382149477`*^9, 3.8719553325601053`*^9}, {
   3.871955382927808*^9, 3.8719554456348763`*^9}, {3.871955513914694*^9, 
   3.8719555222432127`*^9}, {3.871955603894659*^9, 3.871955625413144*^9}, {
   3.871955660087963*^9, 3.871955665477708*^9}, 3.871955696103846*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "rot", "]"}], " ", "//", "MatrixForm", 
  " "}]], "Input",
 CellChangeTimes->{{3.87195556996418*^9, 3.871955595891799*^9}, {
   3.871955632156754*^9, 3.8719556323492527`*^9}, 3.871956005126485*^9, {
   3.871956986172904*^9, 3.8719569890047398`*^9}, {3.871957313925716*^9, 
   3.871957316692428*^9}, {3.8719605761450872`*^9, 3.871960579936249*^9}, {
   3.871961298883184*^9, 3.871961303210236*^9}, 3.8719613493010197`*^9, {
   3.8719615807413*^9, 3.8719615810567427`*^9}, {3.87196996836689*^9, 
   3.8719699687166147`*^9}, 3.8720505649265537`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      SqrtBox[
       FractionBox["1", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
      FractionBox[
       RowBox[{"p", "+", "q"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p"}], "-", "q"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], 
      SqrtBox[
       FractionBox["1", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8719556931658792`*^9, 3.871956005931287*^9, 3.8719569904477997`*^9, 
   3.8719573171266623`*^9, 3.8719605260946827`*^9, {3.87196057193318*^9, 
   3.871960580524465*^9}, 3.871961035384675*^9, 3.871961563499754*^9, 
   3.871961724827343*^9, 3.871969849730095*^9, {3.871969948499279*^9, 
   3.871969969229631*^9}, 3.871970048226815*^9, 3.871970263135054*^9, 
   3.872050567135459*^9, 3.872051552531618*^9, 3.872052058928996*^9, 
   3.872053160825467*^9, 3.872055778031905*^9, 3.8720558188976307`*^9, 
   3.872240729803945*^9, 3.8722407761796*^9, 3.87224084966216*^9, 
   3.872241025573846*^9, 3.872241121072248*^9, 3.872241268751052*^9, {
   3.872241347563271*^9, 3.872241370747032*^9}, 3.872241833997324*^9, 
   3.872241884881212*^9, 3.872242086865665*^9, 3.8722422870205107`*^9, 
   3.8722423173330173`*^9, 3.872242382943726*^9, 3.872242470998474*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rar", " ", "=", 
   RowBox[{"FullSimplify", "[", " ", 
    RowBox[{"rot", " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{"cmat", " ", ".", " ", 
       RowBox[{"Transpose", "[", "rot", "]"}]}], ")"}]}], " ", "]"}]}], " ", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.871955706846756*^9, 3.87195572858391*^9}, {
   3.8719560096543016`*^9, 3.8719560126461487`*^9}, 3.871969955699811*^9, 
   3.872050588565818*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       RowBox[{"p", " ", "q"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}], 
       RowBox[{"p", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "-", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
       RowBox[{"p", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "-", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
       RowBox[{"p", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
        RowBox[{"p", " ", "q"}]]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.871955729375677*^9, 3.871956013044174*^9, 3.8719619278845463`*^9, 
   3.871969852605996*^9, 3.871969956960218*^9, 3.871970056139244*^9, 
   3.871970286195902*^9, 3.872050591470173*^9, 3.872051560598302*^9, 
   3.872051621195261*^9, 3.872052059957274*^9, 3.872053160940016*^9, 
   3.872055778387273*^9, 3.872055820075802*^9, 3.8722407299371147`*^9, 
   3.872240776306902*^9, 3.872240849739102*^9, 3.8722410256497793`*^9, 
   3.872241121145481*^9, 3.8722412688221903`*^9, {3.87224134764115*^9, 
   3.872241370820595*^9}, 3.8722418340745163`*^9, 3.872241884961793*^9, 
   3.872242086939884*^9, 3.8722422870957327`*^9, 3.8722423174063396`*^9, 
   3.8722423830192213`*^9, 3.87224247373177*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rar", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.871956057775755*^9, 3.871956073255414*^9}, {
  3.871956136961657*^9, 3.8719561398887167`*^9}, {3.871970386472742*^9, 
  3.871970394687213*^9}, {3.87205061593316*^9, 3.8720506282567863`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], 
        RowBox[{"p", " ", "q"}]]}], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"]}], 
        RowBox[{"p", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "-", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], "2"], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
        RowBox[{"p", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["q", "2"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "-", 
              RowBox[{"4", " ", "p", " ", "q"}], "+", 
              SuperscriptBox["q", "2"], "+", 
              RowBox[{"2", " ", "p", " ", "q", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"], "-", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], "2"], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
        RowBox[{"p", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["q", "2"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "-", 
              RowBox[{"4", " ", "p", " ", "q"}], "+", 
              SuperscriptBox["q", "2"], "+", 
              RowBox[{"2", " ", "p", " ", "q", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
         RowBox[{"p", " ", "q"}]]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.872050630337021*^9, 3.87205156608984*^9, 3.872051627233548*^9, 
   3.8720517741584*^9, 3.872052060062269*^9, 3.872053161092401*^9, 
   3.872055779141067*^9, 3.8720558203962727`*^9, 3.872240729955558*^9, 
   3.872240776324641*^9, 3.872240849897324*^9, 3.872241025787883*^9, 
   3.872241121221064*^9, 3.872241268898199*^9, {3.872241347715495*^9, 
   3.872241370894072*^9}, 3.872241834153325*^9, 3.872241885037286*^9, 
   3.872242087018899*^9, 3.8722422871701736`*^9, 3.872242317522502*^9, 
   3.872242383094203*^9, 3.872242473961492*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cvec", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"c0", " ", "=", " ", 
  RowBox[{"-", "1"}]}]}], "Input",
 CellChangeTimes->{{3.871956057775755*^9, 3.871956073255414*^9}, {
  3.871956136961657*^9, 3.8719561398887167`*^9}, {3.871970386472742*^9, 
  3.871970394687213*^9}, {3.87205061593316*^9, 3.8720506282567863`*^9}, {
  3.872050662120566*^9, 3.872050669502664*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.871970387161214*^9, 3.8719703951402683`*^9}, 
   3.872050670070136*^9, 3.8720516436960382`*^9, 3.8720520601467323`*^9, 
   3.872053161102992*^9, 3.872055779544623*^9, 3.872055820512349*^9, 
   3.8722407300244217`*^9, 3.872240776504816*^9, 3.8722408499711847`*^9, 
   3.872241025865444*^9, 3.8722411212932987`*^9, 3.872241268970398*^9, {
   3.872241347792644*^9, 3.87224137096747*^9}, 3.8722418342268143`*^9, 
   3.872241885113903*^9, 3.872242087095446*^9, 3.872242287246057*^9, 
   3.872242317629467*^9, 3.872242383174231*^9, 3.872242474058728*^9}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.871970387161214*^9, 3.8719703951402683`*^9}, 
   3.872050670070136*^9, 3.8720516436960382`*^9, 3.8720520601467323`*^9, 
   3.872053161102992*^9, 3.872055779544623*^9, 3.872055820512349*^9, 
   3.8722407300244217`*^9, 3.872240776504816*^9, 3.8722408499711847`*^9, 
   3.872241025865444*^9, 3.8722411212932987`*^9, 3.872241268970398*^9, {
   3.872241347792644*^9, 3.87224137096747*^9}, 3.8722418342268143`*^9, 
   3.872241885113903*^9, 3.872242087095446*^9, 3.872242287246057*^9, 
   3.872242317629467*^9, 3.872242383174231*^9, 3.87224247406026*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"center", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "ycen", ",", "zcen"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.871970295141213*^9, 3.87197031070999*^9}, {
  3.872050679413041*^9, 3.872050692387804*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["p", "2"], "-", 
     SuperscriptBox["q", "2"]}], 
    RowBox[{"4", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
       RowBox[{"p", " ", "q", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}]], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"p", " ", "q"}]], " ", 
    RowBox[{"Sin", "[", "theta", "]"}], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          SuperscriptBox["q", "2"]}], ")"}], "2"], 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"]}], "-", 
          RowBox[{"p", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.871970311252408*^9, 3.872050693044695*^9, 3.872051649477992*^9, 
   3.872052060230006*^9, 3.872053161229253*^9, 3.872055780364147*^9, 
   3.8720558206270933`*^9, 3.8722407300974483`*^9, 3.8722407765232267`*^9, 
   3.8722408500468388`*^9, 3.872241025955028*^9, 3.872241121366868*^9, 
   3.872241269044725*^9, {3.872241347869195*^9, 3.872241371042803*^9}, 
   3.8722418343023252`*^9, 3.872241885191745*^9, 3.872242087169664*^9, 
   3.8722422873204327`*^9, 3.872242317706802*^9, 3.8722423832530203`*^9, 
   3.8722424741991463`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", " ", 
    RowBox[{"rot", " ", ".", " ", "center"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.871956079430187*^9, 3.871956096951529*^9}, {
  3.871970342935034*^9, 3.871970350029743*^9}, {3.8720507041962*^9, 
  3.872050730448256*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["p", "2"]}], "+", 
        SuperscriptBox["q", "2"]}], ")"}], " ", 
      SqrtBox[
       FractionBox["1", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"p", " ", "q"}]], " ", 
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], " ", 
       SqrtBox[
        RowBox[{"-", 
         FractionBox[
          RowBox[{"p", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "-", 
            RowBox[{"4", " ", "p", " ", "q"}], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p", "2"], "-", 
       RowBox[{"4", " ", "p", " ", "q"}], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"2", " ", "p", " ", "q", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], ",", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "+", "q"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        RowBox[{"4", " ", "p", " ", "q"}], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], "-", 
    RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox[
      RowBox[{"p", " ", "q"}]], " ", 
     SqrtBox[
      RowBox[{"-", 
       FractionBox[
        RowBox[{"p", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["p", "2"], "-", 
         RowBox[{"4", " ", "p", " ", "q"}], "+", 
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"2", " ", "p", " ", "q", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
     SqrtBox[
      FractionBox["1", 
       RowBox[{"1", "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "+", "q"}], ")"}], "2"], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], " ", 
     RowBox[{"Sin", "[", "theta", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8719619651546097`*^9, 3.871969860370893*^9, 3.87197007374214*^9, 
   3.8719703503804502`*^9, 3.8719703994614153`*^9, {3.8720507059068203`*^9, 
   3.8720507348914137`*^9}, 3.872051654274811*^9, 3.8720520661078863`*^9, 
   3.8720531613869257`*^9, 3.87205578052719*^9, 3.87205582634296*^9, 
   3.872240730348926*^9, 3.8722407766740017`*^9, 3.872240850118895*^9, 
   3.87224102610497*^9, 3.872241121440507*^9, 3.872241269115922*^9, {
   3.8722413479470453`*^9, 3.87224137111438*^9}, 3.872241834375814*^9, 
   3.872241885270006*^9, 3.872242087243844*^9, 3.872242287395046*^9, 
   3.872242317779529*^9, 3.8722423833312397`*^9, 3.872242491793723*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.871956125192705*^9, 3.871956150672089*^9}, {
   3.871956308860757*^9, 3.8719563098354816`*^9}, 3.8719619763379717`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rot", " ", ".", " ", "cvec"}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"rar", " ", ".", " ", "t"}]}]}], "]"}], " ", "//", "MatrixForm",
    " "}]}]], "Input",
 CellChangeTimes->{{3.8719563128463984`*^9, 3.871956461256502*^9}, {
  3.8719628158540573`*^9, 3.871962819309844*^9}, {3.87196294903153*^9, 
  3.87196294955331*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], " ", 
             SqrtBox[
              FractionBox["1", 
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "+", "q"}], ")"}], "2"], 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}], 
                   ")"}]}]]}]]]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["p", "2"], "-", 
               RowBox[{"4", " ", "p", " ", "q"}], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "p", " ", "q", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "+", 
          FractionBox[
           RowBox[{
            SqrtBox["2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["p", "2"]}], "+", 
              SuperscriptBox["q", "2"]}], ")"}], " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox[
               RowBox[{"p", " ", "q", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "-", 
                RowBox[{"4", " ", "p", " ", "q"}], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["p", "2"], "-", 
              RowBox[{"4", " ", "p", " ", "q"}], "+", 
              SuperscriptBox["q", "2"], "+", 
              RowBox[{"2", " ", "p", " ", "q", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["p", "2"], "+", 
                  SuperscriptBox["q", "2"]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["p", "2"], "-", 
                 RowBox[{"4", " ", "p", " ", "q"}], "+", 
                 SuperscriptBox["q", "2"], "+", 
                 RowBox[{"2", " ", "p", " ", "q", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]], " ", 
            RowBox[{"Sin", "[", "theta", "]"}]}], 
           RowBox[{
            SqrtBox[
             RowBox[{"p", " ", "q"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["p", "2"], "-", 
                 RowBox[{"p", " ", "q"}], "+", 
                 SuperscriptBox["q", "2"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["p", "2"], "+", 
                 SuperscriptBox["q", "2"]}], ")"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}], ")"}]}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"], "-", 
              RowBox[{"2", " ", "p", " ", "q", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"Csc", "[", "theta", "]"}], " ", 
            SqrtBox[
             FractionBox["1", 
              RowBox[{"2", "+", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "+", "q"}], ")"}], "2"]}], 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SqrtBox[
                RowBox[{"p", " ", "q"}]], " ", 
               SqrtBox[
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"p", " ", "q", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
                  RowBox[{
                   SuperscriptBox["p", "2"], "-", 
                   RowBox[{"4", " ", "p", " ", "q"}], "+", 
                   SuperscriptBox["q", "2"], "+", 
                   RowBox[{"2", " ", "p", " ", "q", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["p", "2"], "-", 
                    RowBox[{"p", " ", "q"}], "+", 
                    SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["p", "2"], "+", 
                    SuperscriptBox["q", "2"]}], ")"}], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
               RowBox[{"Csc", "[", "theta", "]"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["p", "2"], "+", 
                    SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["p", "2"], "-", 
                    RowBox[{"4", " ", "p", " ", "q"}], "+", 
                    SuperscriptBox["q", "2"], "+", 
                    RowBox[{"2", " ", "p", " ", "q", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]}], 
             ")"}]}], 
           RowBox[{"p", " ", "q"}]], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
              RowBox[{"p", " ", "q"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "+", "q"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["p", "2"], "-", 
                 RowBox[{"4", " ", "p", " ", "q"}], "+", 
                 SuperscriptBox["q", "2"], "+", 
                 RowBox[{"2", " ", "p", " ", "q", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["p", "2"], "+", 
                    SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["p", "2"], "-", 
                    RowBox[{"4", " ", "p", " ", "q"}], "+", 
                    SuperscriptBox["q", "2"], "+", 
                    RowBox[{"2", " ", "p", " ", "q", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], "-", 
             RowBox[{
              SqrtBox["2"], " ", 
              SqrtBox[
               RowBox[{"p", " ", "q"}]], " ", 
              SqrtBox[
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"p", " ", "q", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
                 RowBox[{
                  SuperscriptBox["p", "2"], "-", 
                  RowBox[{"4", " ", "p", " ", "q"}], "+", 
                  SuperscriptBox["q", "2"], "+", 
                  RowBox[{"2", " ", "p", " ", "q", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
              SqrtBox[
               FractionBox["1", 
                RowBox[{"1", "+", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q"}], ")"}], "2"], 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
              " ", 
              RowBox[{"Sin", "[", "theta", "]"}]}]}], ")"}]}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["q", "2"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.871961983105983*^9, 3.871962819806587*^9, 3.8719629516586103`*^9, 
   3.871969805617833*^9, 3.87197007951898*^9, 3.871970357129796*^9, 
   3.871970403470895*^9, 3.872050766568801*^9, 3.872051685783784*^9, 
   3.872052125915866*^9, 3.872053161549988*^9, 3.872055780999729*^9, 
   3.8720558883931723`*^9, 3.872240730863819*^9, 3.872240777137712*^9, 
   3.8722408503194323`*^9, 3.872241026245781*^9, 3.872241121677953*^9, 
   3.872241269406001*^9, {3.8722413481462*^9, 3.872241371319264*^9}, 
   3.872241834576111*^9, 3.872241885473032*^9, 3.872242087443883*^9, 
   3.872242287594288*^9, 3.8722423180555468`*^9, 3.8722423836165524`*^9, 
   3.872242642663612*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"c0", " ", "+", "  ", 
   RowBox[{"t", " ", ".", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rar", " ", ".", " ", "t"}], " ", "-", " ", 
      RowBox[{"rot", " ", ".", " ", "cvec"}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.871956571715913*^9, 3.871956679445367*^9}, {
  3.8719704439137983`*^9, 3.8719704731122417`*^9}, {3.872050791374851*^9, 
  3.8720507963342047`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.871956578330715*^9, 3.8719566799915867`*^9}, 
   3.871962984366995*^9, 3.871970088643298*^9, {3.871970446794465*^9, 
   3.871970473804875*^9}, 3.872050799059103*^9, 3.8720517006433563`*^9, 
   3.8720521505498257`*^9, 3.8720531616713533`*^9, 3.872055781081345*^9, 
   3.872055911774721*^9, 3.872240731329121*^9, 3.872240777637074*^9, 
   3.872240850393591*^9, 3.872241026323669*^9, 3.872241121750009*^9, 
   3.872241269480608*^9, {3.872241348223233*^9, 3.872241371394359*^9}, 
   3.8722418346511374`*^9, 3.872241885550097*^9, 3.872242087520184*^9, 
   3.872242287674138*^9, 3.8722423181294613`*^9, 3.872242383695882*^9, 
   3.8722426734852*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cpmat", " ", "=", " ", "rar"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpvec", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rot", " ", ".", " ", "cvec"}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"rar", " ", ".", " ", "t"}]}]}], " ", "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"cp0", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"c0", " ", "+", " ", 
    RowBox[{"t", " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rar", " ", ".", " ", "t"}], " ", "-", " ", 
       RowBox[{"rot", " ", ".", " ", "cvec"}]}], ")"}]}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.872050875481427*^9, 3.872050876472073*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], 
       RowBox[{"p", " ", "q"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}], 
       RowBox[{"p", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "-", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
       RowBox[{"p", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"], "-", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
       RowBox[{"p", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
        RowBox[{"p", " ", "q"}]]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.872050824189149*^9, 3.872050877077427*^9, 3.8720517090764637`*^9, 
   3.8720517864238167`*^9, 3.872052150660898*^9, 3.872053161684299*^9, 
   3.872055781305004*^9, 3.872055911946745*^9, 3.8722407314771423`*^9, 
   3.872240777797222*^9, 3.872240850467661*^9, 3.872241026404604*^9, 
   3.872241121823249*^9, 3.872241269552993*^9, {3.872241348302244*^9, 
   3.872241371467494*^9}, 3.8722418347240133`*^9, 3.872241885624207*^9, 
   3.872242087603526*^9, 3.872242287747266*^9, 3.8722423182039003`*^9, 
   3.872242383767991*^9, 3.8722426736342163`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], "2"], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "+", 
      FractionBox[
       RowBox[{
        SqrtBox["2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["p", "2"]}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SqrtBox[
         RowBox[{"-", 
          FractionBox[
           RowBox[{"p", " ", "q", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
           RowBox[{
            SuperscriptBox["p", "2"], "-", 
            RowBox[{"4", " ", "p", " ", "q"}], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]], " ", 
        RowBox[{"Sin", "[", "theta", "]"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{"p", " ", "q"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}], ")"}]}], ",", 
   
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"p", " ", "q"}]], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"], "-", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"Csc", "[", "theta", "]"}], " ", 
          SqrtBox[
           FractionBox["1", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "+", "q"}], ")"}], "2"]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SqrtBox[
              RowBox[{"p", " ", "q"}]], " ", 
             SqrtBox[
              RowBox[{"-", 
               FractionBox[
                RowBox[{"p", " ", "q", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
                RowBox[{
                 SuperscriptBox["p", "2"], "-", 
                 RowBox[{"4", " ", "p", " ", "q"}], "+", 
                 SuperscriptBox["q", "2"], "+", 
                 RowBox[{"2", " ", "p", " ", "q", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "-", 
                   RowBox[{"p", " ", "q"}], "+", 
                   SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "+", 
                   SuperscriptBox["q", "2"]}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
             RowBox[{"Csc", "[", "theta", "]"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "+", 
                   SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["p", "2"], "-", 
                  RowBox[{"4", " ", "p", " ", "q"}], "+", 
                  SuperscriptBox["q", "2"], "+", 
                  RowBox[{"2", " ", "p", " ", "q", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]}], 
           ")"}]}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
            RowBox[{"p", " ", "q"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["p", "2"], "-", 
               RowBox[{"4", " ", "p", " ", "q"}], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "p", " ", "q", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "+", 
                   SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["p", "2"], "-", 
                  RowBox[{"4", " ", "p", " ", "q"}], "+", 
                  SuperscriptBox["q", "2"], "+", 
                  RowBox[{"2", " ", "p", " ", "q", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], "-", 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{"p", " ", "q"}]], " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox[
               RowBox[{"p", " ", "q", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "-", 
                RowBox[{"4", " ", "p", " ", "q"}], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
            SqrtBox[
             FractionBox["1", 
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "+", "q"}], ")"}], "2"], 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
            " ", 
            RowBox[{"Sin", "[", "theta", "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}], ")"}]}], 
     ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.872050824189149*^9, 3.872050877077427*^9, 3.8720517090764637`*^9, 
   3.8720517864238167`*^9, 3.872052150660898*^9, 3.872053161684299*^9, 
   3.872055781305004*^9, 3.872055911946745*^9, 3.8722407314771423`*^9, 
   3.872240777797222*^9, 3.872240850467661*^9, 3.872241026404604*^9, 
   3.872241121823249*^9, 3.872241269552993*^9, {3.872241348302244*^9, 
   3.872241371467494*^9}, 3.8722418347240133`*^9, 3.872241885624207*^9, 
   3.872242087603526*^9, 3.872242287747266*^9, 3.8722423182039003`*^9, 
   3.872242383767991*^9, 3.872242761849173*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.872050824189149*^9, 3.872050877077427*^9, 3.8720517090764637`*^9, 
   3.8720517864238167`*^9, 3.872052150660898*^9, 3.872053161684299*^9, 
   3.872055781305004*^9, 3.872055911946745*^9, 3.8722407314771423`*^9, 
   3.872240777797222*^9, 3.872240850467661*^9, 3.872241026404604*^9, 
   3.872241121823249*^9, 3.872241269552993*^9, {3.872241348302244*^9, 
   3.872241371467494*^9}, 3.8722418347240133`*^9, 3.872241885624207*^9, 
   3.872242087603526*^9, 3.872242287747266*^9, 3.8722423182039003`*^9, 
   3.872242383767991*^9, 3.872242792247562*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", "cp0"}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.87205188924839*^9, 3.872051895751671*^9}, {
   3.872056394049391*^9, 3.8720563976676188`*^9}, 3.872056630780637*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Csc", "[", "theta", "]"}], "2"], 
     RowBox[{"p", " ", "q"}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        RowBox[{"4", " ", "p", " ", "q"}], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"]}], 
     RowBox[{"p", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q", "2"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
       SuperscriptBox[
        RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
      RowBox[{"p", " ", "q"}]]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}]], ",", "0", 
   ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"p", "+", "q"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p", "2"], "+", 
        SuperscriptBox["q", "2"], "-", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
      SqrtBox[
       FractionBox["1", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
     RowBox[{"p", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"p", "-", "q"}], ")"}], "3"], " ", "q", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        RowBox[{"4", " ", "p", " ", "q"}], "+", 
        SuperscriptBox["q", "2"], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]]}], ",", "0",
    ",", "0", ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q"}], ")"}], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], "2"], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["p", "2"], "-", 
           RowBox[{"4", " ", "p", " ", "q"}], "+", 
           SuperscriptBox["q", "2"], "+", 
           RowBox[{"2", " ", "p", " ", "q", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "+", 
      FractionBox[
       RowBox[{
        SqrtBox["2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["p", "2"]}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SqrtBox[
         RowBox[{"-", 
          FractionBox[
           RowBox[{"p", " ", "q", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
           RowBox[{
            SuperscriptBox["p", "2"], "-", 
            RowBox[{"4", " ", "p", " ", "q"}], "+", 
            SuperscriptBox["q", "2"], "+", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p", "2"], "-", 
          RowBox[{"4", " ", "p", " ", "q"}], "+", 
          SuperscriptBox["q", "2"], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["p", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"4", " ", "p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"], "+", 
             RowBox[{"2", " ", "p", " ", "q", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]], " ", 
        RowBox[{"Sin", "[", "theta", "]"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{"p", " ", "q"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "-", 
             RowBox[{"p", " ", "q"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}], ")"}]}], ",", 
   
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"p", " ", "q"}]], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"p", "+", "q"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["q", "2"], "-", 
            RowBox[{"2", " ", "p", " ", "q", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"Csc", "[", "theta", "]"}], " ", 
          SqrtBox[
           FractionBox["1", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "+", "q"}], ")"}], "2"]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SqrtBox[
              RowBox[{"p", " ", "q"}]], " ", 
             SqrtBox[
              RowBox[{"-", 
               FractionBox[
                RowBox[{"p", " ", "q", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
                RowBox[{
                 SuperscriptBox["p", "2"], "-", 
                 RowBox[{"4", " ", "p", " ", "q"}], "+", 
                 SuperscriptBox["q", "2"], "+", 
                 RowBox[{"2", " ", "p", " ", "q", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "-", 
                   RowBox[{"p", " ", "q"}], "+", 
                   SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "+", 
                   SuperscriptBox["q", "2"]}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]], " ", 
             RowBox[{"Csc", "[", "theta", "]"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "+", 
                   SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["p", "2"], "-", 
                  RowBox[{"4", " ", "p", " ", "q"}], "+", 
                  SuperscriptBox["q", "2"], "+", 
                  RowBox[{"2", " ", "p", " ", "q", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]}], 
           ")"}]}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"]}], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}], "4"], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}], 
            RowBox[{"p", " ", "q"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"p", "+", "q"}], ")"}], "2"], 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["p", "2"], "-", 
               RowBox[{"4", " ", "p", " ", "q"}], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "p", " ", "q", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["p", "2"], "+", 
                   SuperscriptBox["q", "2"]}], ")"}]}], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["p", "2"], "-", 
                  RowBox[{"4", " ", "p", " ", "q"}], "+", 
                  SuperscriptBox["q", "2"], "+", 
                  RowBox[{"2", " ", "p", " ", "q", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]]}]], "-", 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{"p", " ", "q"}]], " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox[
               RowBox[{"p", " ", "q", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["p", "2"], "-", 
                RowBox[{"4", " ", "p", " ", "q"}], "+", 
                SuperscriptBox["q", "2"], "+", 
                RowBox[{"2", " ", "p", " ", "q", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "theta"}], "]"}]}]}]]}]], " ", 
            SqrtBox[
             FractionBox["1", 
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"p", "+", "q"}], ")"}], "2"], 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "theta", "]"}], "2"]}], ")"}]}]]}]]], 
            " ", 
            RowBox[{"Sin", "[", "theta", "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"p", "-", "q"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], ")"}]}], ")"}]}], 
     ")"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.872050847365402*^9, 3.8720508808498573`*^9, 3.872051716029755*^9, 
   3.872051790887109*^9, 3.87205189760719*^9, 3.872052160902172*^9, 
   3.8720531618205957`*^9, 3.87205578140949*^9, 3.872055926215605*^9, 
   3.872056399016748*^9, 3.872056631213182*^9, 3.87224073155936*^9, 
   3.872240777916065*^9, 3.8722410264862623`*^9, 3.872241121900137*^9, 
   3.8722412696684*^9, {3.872241348384472*^9, 3.872241371544057*^9}, 
   3.872241834823962*^9, 3.872241885704492*^9, 3.872242087690442*^9, 
   3.8722422878240013`*^9, 3.872242318322077*^9, 3.872242383847488*^9, 
   3.8722427923630857`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"cpmat", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"cpmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"cpvec", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", "cp0"}], "}"}], "  ", "//", 
  "FortranForm"}]], "Input",
 CellChangeTimes->{{3.8722428759296513`*^9, 3.872242885448831*^9}}],

Cell["\<\
        List(-(Csc(theta)**2/(p*q)),-(((p**2 - 4*p*q + q**2 + \
2*p*q*Cos(2*theta))*Csc(theta)**2)/
     -     (p*q*(2*(p**2 + q**2) + (p - q)**2*Csc(theta)**2))),
     -  (4*(p + q)**2 - ((p - q)**4*Csc(theta)**2*(1 + \
Csc(theta)**2))/(p*q))/((p - q)**2*(2*(p**2 + q**2) + (p - \
q)**2*Csc(theta)**2)),0,
     -  (-2*(p + q)*(p**2 + q**2 - \
2*p*q*Cos(2*theta))*Csc(theta)**2*Sqrt(1/(1 + (p + q)**2/((p - q)**2*(1 + \
Csc(theta)**2)))))/
     -   (p*(p - q)**3*q*Sqrt(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))*
     -     Sqrt((2*(p**2 + q**2) + (p - q)**2*Csc(theta)**2)/((p - \
q)**2*(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))))),0,0,
     -  -2*((-2*(p + q)*Sqrt(1/(1 + (p + q)**2/((p - q)**2*(1 + \
Csc(theta)**2)))))/
     -      ((p - q)*Sqrt(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))) + 
     -     (Sqrt(2)*(-p**2 + q**2)*Sqrt(-((p*q*(-3 + Cos(2*theta)))/(p**2 - \
4*p*q + q**2 + 2*p*q*Cos(2*theta))))*
     -        Sqrt(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))*
     -        Sqrt((2*(p**2 + q**2) + (p - q)**2*Csc(theta)**2)/((p - \
q)**2*(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))))*Sin(theta))/
     -      (Sqrt(p*q)*(-2*(p**2 - p*q + q**2) + (p**2 + q**2)*Cos(2*theta)))),
     -  -((((p + q)**2*(p**2 + q**2 - \
2*p*q*Cos(2*theta))*Csc(theta)*Sqrt(1/(2 + (2*(p + q)**2)/((p - q)**2*(1 + \
Csc(theta)**2))))*
     -          (4*Sqrt(p*q)*Sqrt(-((p*q*(-3 + Cos(2*theta)))/(p**2 - 4*p*q + \
q**2 + 2*p*q*Cos(2*theta)))) + 
     -            (p - q)**2*Sqrt(((p - q)**2*(-3 + Cos(2*theta)))/(-2*(p**2 \
- p*q + q**2) + (p**2 + q**2)*Cos(2*theta)))*Csc(theta)*
     -             Sqrt((2*(p**2 + q**2) + (p - q)**2*Csc(theta)**2)/((p - \
q)**2*(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))))))/(p*q) + 
     -       2*(4*(p + q)**2 - ((p - q)**4*Csc(theta)**2*(1 + \
Csc(theta)**2))/(p*q))*
     -        ((p + q)**2/(2.*(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))*
     -             Sqrt((2*(p**2 + q**2) + (p - q)**2*Csc(theta)**2)/((p - \
q)**2*(p**2 - 4*p*q + q**2 + 2*p*q*Cos(2*theta))))) - 
     -          Sqrt(2)*Sqrt(p*q)*Sqrt(-((p*q*(-3 + Cos(2*theta)))/(p**2 - \
4*p*q + q**2 + 2*p*q*Cos(2*theta))))*
     -           Sqrt(1/(1 + (p + q)**2/((p - q)**2*(1 + \
Csc(theta)**2))))*Sin(theta)))/
     -     ((p - q)**2*(2*(p**2 + q**2) + (p - q)**2*Csc(theta)**2))),0)\
\>", "Output",
 CellChangeTimes->{3.8722428863838263`*^9}]
}, Open  ]]
},
WindowSize->{1386, 633},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1837, 38, 209, "Input"],
Cell[2420, 62, 740, 12, 53, "Output"],
Cell[3163, 76, 789, 14, 38, "Output"],
Cell[3955, 92, 954, 20, 75, "Output"],
Cell[4912, 114, 1040, 23, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5989, 142, 994, 24, 32, "Input"],
Cell[6986, 168, 1638, 36, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8661, 209, 914, 22, 55, "Input"],
Cell[9578, 233, 801, 21, 92, "Output"],
Cell[10382, 256, 1178, 34, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11597, 295, 1262, 30, 121, "Input"],
Cell[12862, 327, 1211, 31, 94, "Output"],
Cell[14076, 360, 1495, 39, 103, "Output"],
Cell[15574, 401, 1855, 50, 100, "Output"],
Cell[17432, 453, 2042, 56, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19511, 514, 1067, 23, 55, "Input"],
Cell[20581, 539, 2129, 55, 100, "Output"],
Cell[22713, 596, 5033, 142, 235, "Output"]
}, Open  ]],
Cell[27761, 741, 337, 4, 55, "Input"],
Cell[CellGroupData[{
Cell[28123, 749, 601, 10, 32, "Input"],
Cell[28727, 761, 5218, 140, 188, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33982, 906, 463, 11, 55, "Input"],
Cell[34448, 919, 7883, 222, 376, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42368, 1146, 284, 4, 32, "Input"],
Cell[42655, 1152, 8280, 228, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50972, 1385, 452, 9, 55, "Input"],
Cell[51427, 1396, 654, 10, 32, "Output"],
Cell[52084, 1408, 615, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52736, 1422, 241, 5, 32, "Input"],
Cell[52980, 1429, 1878, 54, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54895, 1488, 326, 7, 32, "Input"],
Cell[55224, 1497, 6031, 173, 261, "Output"]
}, Open  ]],
Cell[61270, 1673, 168, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[61463, 1679, 438, 11, 32, "Input"],
Cell[61904, 1692, 14703, 372, 302, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76644, 2069, 446, 10, 32, "Input"],
Cell[77093, 2081, 694, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77824, 2096, 728, 19, 77, "Input"],
Cell[78555, 2117, 7741, 220, 376, "Output"],
Cell[86299, 2339, 13248, 357, 873, "Output"],
Cell[99550, 2698, 597, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100184, 2712, 1464, 44, 55, "Input"],
Cell[101651, 2758, 17649, 494, 969, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119337, 3257, 1418, 44, 55, "Input"],
Cell[120758, 3303, 2356, 42, 424, "Output"]
}, Open  ]]
}
]
*)

